<script type="text/x-red" data-template-name="xdisplay-mqtt-out">
    <div class="form-row">
        <label for="node-input-name" class="l-width">Name</label>
        <input type="text" id="node-input-name" data-i18n="[placeholder]placeholder.name">
    </div>
    <div class="form-row">
        <label for="node-input-broker" class="l-width">X-Display</label>
        <input type="text" id="node-input-broker">
    </div>
    <div class="form-row">
        <label for="node-input-action">Action</label>
        <input type="text" id="node-input-action">
    </div>
</script>

<script type='text/javascript'>

    const actionMapping = {
        screenoff: "Turn on/off X-Display ",
        verr: "Lock/Unlock X-Display ",
        AutoOff: "Set X-Display  sleep timer"
    }

    RED.nodes.registerType('xdisplay-mqtt-out', {
        category: 'GCE X\u2013Display',
        color: '#80c600',
        icon: "font-awesome/fa-microchip",
        defaults: {
            name: {
                value: ""
            },
            broker: {
                type: "gateway",
                required: true
            },
            action: { value:"screenoff"},
        },
        inputs: 1,
        outputs: 0,
        // outputLabels: ["value"],
        paletteLabel: 'Command',
        label: function () {
            var label = 'X\u2013Display command #0014';
            if (this.name) {
                label = this.name;
            } else if (this.action){

                return actionMapping[this.action]
            }
            return label;
        },
        oneditprepare: function() {
			$("#node-input-action").typedInput({
				types: [
					{
						value: "screenoff",
						options: [
							{ value: "screenoff", label: actionMapping["screenoff"]},
							{ value: "verr", label: actionMapping["verr"]},
							{ value: "AutoOff", label: actionMapping["AutoOff"]},
						]
					}
				]
			})
		}
    });

</script>